{"ast":null,"code":"var _jsxFileName = \"/home/exacta/Documentos/BancoDados/sfront/sfilmes_frontend/src/Contexts/UserContext.js\";\nimport React from 'react';\nimport { TOKEN_POST, USER_GET } from '../api';\nimport { useNavigate } from 'react-router-dom';\nexport const UserContext = React.createContext();\nexport const UserStorage = ({\n  children\n}) => {\n  const [data, setData] = React.useState(null);\n  const [login, setLogin] = React.useState(null);\n  const [loading, setLoading] = React.useState(false);\n  const [error, setError] = React.useState(null);\n  const navigate = useNavigate();\n\n  async function getUser(token) {\n    const {\n      url,\n      options\n    } = USER_GET(token);\n    const response = await fetch(url, options);\n    const json = await response.json();\n    await setData(json.data);\n    setLogin(true);\n  }\n\n  async function userLogin(email, password) {\n    console.log(email);\n    console.log(password);\n\n    try {\n      setError(null);\n      setLoading(true);\n      fetch('https://sfilmes-backend.herokuapp.com/auth', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          email: email,\n          password: password\n        })\n      }).then(res => res.json()).then(data => {\n        window.localStorage.setItem('token', data.token);\n        console.log(data);\n      });\n    } catch (err) {\n      setError(err.message);\n      setLogin(false);\n    } finally {\n      setLoading(false);\n      if (localStorage.token) navigate('/user');\n    }\n  }\n\n  const userLogout = React.useCallback(async function () {\n    await setData(null);\n    setError(null);\n    setLoading(false);\n    await setLogin(false);\n    await window.localStorage.removeItem('token');\n    navigate('/login');\n  }, [navigate]);\n  return /*#__PURE__*/React.createElement(UserContext.Provider, {\n    value: {\n      userLogin,\n      userLogout,\n      login,\n      data,\n      error,\n      loading\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 5\n    }\n  }, children);\n};","map":{"version":3,"sources":["/home/exacta/Documentos/BancoDados/sfront/sfilmes_frontend/src/Contexts/UserContext.js"],"names":["React","TOKEN_POST","USER_GET","useNavigate","UserContext","createContext","UserStorage","children","data","setData","useState","login","setLogin","loading","setLoading","error","setError","navigate","getUser","token","url","options","response","fetch","json","userLogin","email","password","console","log","method","headers","body","JSON","stringify","then","res","window","localStorage","setItem","err","message","userLogout","useCallback","removeItem"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { TOKEN_POST, USER_GET } from '../api';\nimport { useNavigate } from 'react-router-dom';\n\nexport const UserContext = React.createContext();\n\nexport const UserStorage = ({ children }) => {\n  const [data, setData] = React.useState(null);\n  const [login, setLogin] = React.useState(null);\n  const [loading, setLoading] = React.useState(false);\n  const [error, setError] = React.useState(null);\n  const navigate = useNavigate();\n\n  async function getUser(token) {\n    const { url, options } = USER_GET(token);\n    const response = await fetch(url, options);\n    const json = await response.json();\n    await setData(json.data);\n    setLogin(true);\n  }\n\n  async function userLogin(email, password) {\n    console.log(email);\n    console.log(password);\n    try {\n      setError(null);\n      setLoading(true);\n      fetch('https://sfilmes-backend.herokuapp.com/auth', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          email: email,\n          password: password,\n        }),\n      })\n        .then((res) => res.json())\n        .then((data) => {\n          window.localStorage.setItem('token', data.token);\n          console.log(data);\n        });\n    } catch (err) {\n      setError(err.message);\n      setLogin(false);\n    } finally {\n      setLoading(false);\n      if (localStorage.token) navigate('/user');\n    }\n  }\n  const userLogout = React.useCallback(\n    async function () {\n      await setData(null);\n      setError(null);\n      setLoading(false);\n      await setLogin(false);\n      await window.localStorage.removeItem('token');\n      navigate('/login');\n    },\n    [navigate],\n  );\n\n  return (\n    <UserContext.Provider\n      value={{ userLogin, userLogout, login, data, error, loading }}\n    >\n      {children}\n    </UserContext.Provider>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}